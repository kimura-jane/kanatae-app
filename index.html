<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>ãŠã«ãã‚Šå±‹ã‹ãªãŸã‘</title>

  <meta name="description" content="ãŠã«ãã‚Šå±‹ã‹ãªãŸã‘ã®å‡ºåº—ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ»ãƒãƒƒãƒ—ãƒ»ã‚¯ãƒ¼ãƒãƒ³">
  <meta name="theme-color" content="#f5a623">

  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="onigiriya_kanatake_192.png">

  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" defer></script>

  <link rel="stylesheet" href="style.css">

  <!-- â˜…é‡è¦ï¼šãƒ‡ãƒ¼ã‚¿ã¯ spots-all.jsï¼ˆwindow.spotsAllByYearï¼‰ã‚’åŸºæº–ã«ã™ã‚‹ -->
  <script src="spots-all.js?v=20260102" defer></script>

  <!-- map ç”¨ï¼ˆwindow.spots ã‚’ä½¿ã†ãªã‚‰æ®‹ã™ã€‚ç„¡ã„å ´åˆã¯å…¨ä½“ã‹ã‚‰è‡ªå‹•ã§ä½œã‚‹ã®ã§ã‚ã£ã¦ã‚‚OKï¼‰ -->
  <script src="spots.js?v=20260102" defer></script>
</head>

<body>
  <div class="app">
    <header class="header">
      <h1>
        <img src="icon.png" alt="" class="header-icon">
        ãŠã«ãã‚Šå±‹ã‹ãªãŸã‘
      </h1>
    </header>

    <nav class="tab-nav">
      <button class="tab-btn active" data-tab="calendar">ğŸ“… ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼</button>
      <button class="tab-btn" data-tab="map">ğŸ“ ãƒãƒƒãƒ—</button>
      <button class="tab-btn" data-tab="menu">ğŸ™ ãƒ¡ãƒ‹ãƒ¥ãƒ¼</button>
      <button class="tab-btn" data-tab="coupon">ğŸ« ã‚¯ãƒ¼ãƒãƒ³</button>
      <button class="tab-btn" data-tab="settings">âš™ï¸ è¨­å®š</button>
    </nav>

    <main class="tab-content">
      <section class="tab-pane active" id="calendar">
        <div class="calendar">
          <div class="calendar-header">
            <button class="calendar-nav" id="prevMonth">â—€</button>
            <h2 class="calendar-title" id="calendarTitle">----</h2>
            <button class="calendar-nav" id="nextMonth">â–¶</button>
          </div>
          <div class="calendar-grid" id="calendarGrid"></div>
        </div>
      </section>

      <section class="tab-pane" id="map-pane">
        <div id="map"></div>
        <section class="spot-card" id="listCard">
          <p class="spot-title">å‡ºåº—ãƒªã‚¹ãƒˆï¼ˆã‚¿ãƒƒãƒ—ã§åœ°å›³ï¼‰</p>
          <ol class="spot-list" id="spotList"></ol>
        </section>
      </section>

      <section class="tab-pane" id="menu">
        <div class="menu-container">
          <img src="IMG_7605.jpeg" alt="ãŠã«ãã‚Šå±‹ã‹ãªãŸã‘ ãƒ¡ãƒ‹ãƒ¥ãƒ¼" class="menu-image">
        </div>
      </section>

      <section class="tab-pane" id="coupon">
        <div class="coupon">
          <img src="icon.png" alt="ã‹ãªãŸã‘" class="coupon-icon">
          <h2 class="coupon-title">ã‚¹ãƒã‚¤ãƒ«ã‚¯ãƒ¼ãƒãƒ³</h2>
          <p class="coupon-desc">ã“ã®ç”»é¢ã‚’åº—ä¸»ã«è¦‹ã›ã¦ã­</p>

          <div class="coupon-card">
            <p class="coupon-label">ç‰¹å…¸</p>
            <p class="coupon-value">ğŸ˜Š åº—ä¸»ã®ç¬‘é¡”</p>
          </div>
          <p class="coupon-note">â€» ä½•åº¦ã§ã‚‚ä½¿ãˆã¾ã™</p>
        </div>
      </section>

      <section class="tab-pane" id="settings">
        <div class="settings">
          <h2 class="settings-title">ğŸ”” é€šçŸ¥è¨­å®š</h2>

          <div class="settings-card">
            <p class="settings-card-title">â° é€šçŸ¥ã™ã‚‹æ™‚é–“</p>
            <label class="settings-option">
              <input type="radio" name="notifyHour" value="18">
              <span class="settings-option-text">å‰æ—¥ 18:00 ã«é€šçŸ¥</span>
            </label>
            <label class="settings-option">
              <input type="radio" name="notifyHour" value="21" checked>
              <span class="settings-option-text">å‰æ—¥ 21:00 ã«é€šçŸ¥</span>
            </label>
          </div>

          <div class="settings-card">
            <p class="settings-card-title">ğŸ“ é€šçŸ¥ã™ã‚‹å‡ºåº—å ´æ‰€</p>
            <label class="settings-option">
              <input type="checkbox" id="place_all" checked>
              <span class="settings-option-text">ã™ã¹ã¦ã®å‡ºåº—ã‚’é€šçŸ¥ã™ã‚‹</span>
            </label>

            <div id="placeList" class="settings-places">
              <p class="settings-places-title">ã¾ãŸã¯ã€å ´æ‰€ã‚’é¸ã‚“ã§é€šçŸ¥ï¼š</p>
              <label class="settings-option">
                <input type="checkbox" class="placeChk" value="sakura_hospital">
                <span class="settings-option-text">å·å£ã•ãã‚‰ç—…é™¢</span>
              </label>
              <label class="settings-option">
                <input type="checkbox" class="placeChk" value="dokkyo">
                <span class="settings-option-text">ç¨å”å¤§å­¦</span>
              </label>
              <label class="settings-option">
                <input type="checkbox" class="placeChk" value="saitama_cityhall">
                <span class="settings-option-text">ã•ã„ãŸã¾å¸‚å½¹æ‰€</span>
              </label>
              <label class="settings-option">
                <input type="checkbox" class="placeChk" value="dynam_togasaki">
                <span class="settings-option-text">ãƒ€ã‚¤ãƒŠãƒ æˆ¸ã‚±å´</span>
              </label>
            </div>

            <div class="settings-note">
              <span class="settings-note-icon">ğŸ’¡</span>
              <span>ã€Œã™ã¹ã¦ã®å‡ºåº—ã‚’é€šçŸ¥ã™ã‚‹ã€ãŒONã®å ´åˆã€å€‹åˆ¥ã®å ´æ‰€é¸æŠã¯ç„¡åŠ¹ã«ãªã‚Šã¾ã™</span>
            </div>
          </div>

          <button class="settings-btn" id="pushBtn" type="button">
            ğŸ”” é€šçŸ¥ã‚’å—ã‘å–ã‚‹
          </button>
          <p id="pushStatus" class="settings-status"></p>
        </div>
      </section>
    </main>
  </div>

  <div class="modal-overlay" id="modal">
    <div class="modal">
      <p class="modal-date" id="modalDate"></p>
      <h3 class="modal-title" id="modalTitle"></h3>
      <p class="modal-time" id="modalTime"></p>
      <a class="modal-btn" id="modalMap" href="#" target="_blank">Googleãƒãƒƒãƒ—ã§é–‹ã</a>
      <button class="modal-btn modal-close" id="modalClose">é–‰ã˜ã‚‹</button>
    </div>
  </div>

  <script>
    const BASE = new URL("./", location.href).pathname;
    const SW_URL = BASE + "sw.js";
    const PUSH_API_BASE = "https://kanatae-push.la-kofu.workers.dev";

    // ===== tabs =====
    const tabBtns = document.querySelectorAll('.tab-btn');
    const tabPanes = document.querySelectorAll('.tab-pane');
    let mapInitialized = false;
    let mapInstance = null;
    let markersArray = [];

    tabBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        const tabId = btn.dataset.tab;
        tabBtns.forEach(b => b.classList.remove('active'));
        tabPanes.forEach(p => p.classList.remove('active'));
        btn.classList.add('active');

        if (tabId === 'map') document.getElementById('map-pane').classList.add('active');
        else document.getElementById(tabId).classList.add('active');

        if (tabId === 'map' && !mapInitialized) { initMap(); mapInitialized = true; }
        if (tabId === 'map' && mapInstance) setTimeout(() => mapInstance.invalidateSize(), 100);
      });
    });

    // ===== calendar =====
    let currentYear = 2025;
    let currentMonth = 12;

    let minYM = null; // {y,m}
    let maxYM = null; // {y,m}
    function ymToNum(y, m) { return y * 100 + m; }

    function clampYM(y, m) {
      if (!minYM || !maxYM) return { y, m };
      const n = ymToNum(y, m);
      const minN = ymToNum(minYM.y, minYM.m);
      const maxN = ymToNum(maxYM.y, maxYM.m);
      if (n < minN) return { y: minYM.y, m: minYM.m };
      if (n > maxN) return { y: maxYM.y, m: maxYM.m };
      return { y, m };
    }

    // ---- Data helpersï¼ˆspotsAllByYearã‚’æ­£å¼å¯¾å¿œï¼‰----
    function getAllSpotsFlat() {
      // 1) map ç”¨ã® window.spots ãŒã‚ã‚Œã°ãã‚Œï¼ˆäº’æ›ï¼‰
      if (Array.isArray(window.spots) && window.spots.length) return window.spots;

      // 2) spotsAllByYear ã‚’å¹³å¦åŒ–
      if (window.spotsAllByYear && typeof window.spotsAllByYear === 'object') {
        const years = Object.keys(window.spotsAllByYear).map(Number).filter(n => Number.isFinite(n)).sort((a,b)=>a-b);
        const flat = [];
        years.forEach(y => {
          const arr = window.spotsAllByYear[y] || [];
          arr.forEach(s => flat.push({ ...s, year: y }));
        });
        return flat;
      }

      // 3) æ—§å½¢å¼
      if (Array.isArray(window.spotsAllYearly) && window.spotsAllYearly.length) return window.spotsAllYearly;
      if (Array.isArray(window.spotsAll) && window.spotsAll.length) return window.spotsAll;

      return [];
    }

    function getSpotsForYM(year, month) {
      // spotsAllByYear ãŒã‚ã‚‹ãªã‚‰ã€ãã‚Œã‚’åŸºæº–ã« â€œå¹´ï¼‹æœˆâ€ ã§ç¢ºå®Ÿã«çµã‚‹
      if (window.spotsAllByYear && typeof window.spotsAllByYear === 'object') {
        const arr = window.spotsAllByYear[year] || [];
        return arr.filter(spot => {
          const match = (spot.date || "").match(/(\d+)\/(\d+)/);
          if (!match) return false;
          const m = parseInt(match[1], 10);
          return m === month;
        });
      }

      // fallbackï¼ˆæ—§å½¢å¼ï¼‰
      const spots = getAllSpotsFlat();
      return spots.filter(spot => {
        if (spot.year != null && Number(spot.year) !== Number(year)) return false;
        const match = (spot.date || "").match(/(\d+)\/(\d+)/);
        if (!match) return false;
        const m = parseInt(match[1], 10);
        return m === month;
      });
    }

    function getEventsForMonth(year, month) {
      const spots = getSpotsForYM(year, month);
      const events = {};
      spots.forEach(spot => {
        const match = (spot.date || "").match(/(\d+)\/(\d+)/);
        if (!match) return;
        const d = parseInt(match[2], 10);
        if (!events[d]) events[d] = [];
        events[d].push(spot);
      });
      return events;
    }

    function computeMinMaxYM() {
      const list = getAllSpotsFlat();
      let minN = Infinity, maxN = -Infinity;

      list.forEach(spot => {
        const y = Number(spot.year);
        if (!Number.isFinite(y)) return;

        const match = (spot.date || "").match(/(\d+)\/(\d+)/);
        if (!match) return;
        const m = parseInt(match[1], 10);
        if (!(m >= 1 && m <= 12)) return;

        const n = ymToNum(y, m);
        if (n < minN) minN = n;
        if (n > maxN) maxN = n;
      });

      if (!isFinite(minN) || !isFinite(maxN)) {
        minYM = null; maxYM = null;
        return;
      }

      minYM = { y: Math.floor(minN / 100), m: minN % 100 };
      maxYM = { y: Math.floor(maxN / 100), m: maxN % 100 };
    }

    function updateNavDisabled() {
      const prevBtn = document.getElementById('prevMonth');
      const nextBtn = document.getElementById('nextMonth');
      if (!minYM || !maxYM) { prevBtn.disabled = false; nextBtn.disabled = false; return; }

      const curN = ymToNum(currentYear, currentMonth);
      prevBtn.disabled = curN <= ymToNum(minYM.y, minYM.m);
      nextBtn.disabled = curN >= ymToNum(maxYM.y, maxYM.m);
    }

    function getShortName(name) {
      const shortcuts = {
        'å·å£ã•ãã‚‰ç—…é™¢': 'ã•ãã‚‰ç—…é™¢',
        'ç¨å”å¤§å­¦ è‰åŠ ã‚­ãƒ£ãƒ³ãƒ‘ã‚¹': 'ç¨å”å¤§å­¦',
        'ã•ã„ãŸã¾å¸‚å½¹æ‰€ æµ¦å’Œæœ¬åºèˆ': 'ã•ã„ãŸã¾å¸‚å½¹æ‰€',
        'ãƒ€ã‚¤ãƒŠãƒ æˆ¸ãƒ¶å´åº—': 'ãƒ€ã‚¤ãƒŠãƒ '
      };
      return shortcuts[name] || (name || "").substring(0, 6);
    }

    function renderCalendar() {
      const title = document.getElementById('calendarTitle');
      const grid = document.getElementById('calendarGrid');

      title.textContent = `${currentYear}å¹´${currentMonth}æœˆ`;

      const firstDay = new Date(currentYear, currentMonth - 1, 1);
      const lastDay = new Date(currentYear, currentMonth, 0);
      const daysInMonth = lastDay.getDate();
      const startDow = firstDay.getDay();

      const events = getEventsForMonth(currentYear, currentMonth);

      const today = new Date();
      const isCurrentMonth = today.getFullYear() === currentYear && (today.getMonth() + 1) === currentMonth;
      const todayDate = today.getDate();

      let html = ['æ—¥','æœˆ','ç«','æ°´','æœ¨','é‡‘','åœŸ'].map(d => `<div class="calendar-dow">${d}</div>`).join('');
      for (let i = 0; i < startDow; i++) html += '<div class="calendar-day empty"></div>';

      for (let d = 1; d <= daysInMonth; d++) {
        const hasEvent = !!(events[d] && events[d].length);
        const isToday = isCurrentMonth && d === todayDate;

        let classes = 'calendar-day';
        if (hasEvent) classes += ' has-event';
        if (isToday) classes += ' today';

        const placeName = hasEvent ? `<div class="calendar-place">${getShortName(events[d][0].name)}</div>` : '';
        html += `<div class="${classes}" data-day="${d}">
          <span class="calendar-date">${d}</span>
          ${placeName}
        </div>`;
      }

      grid.innerHTML = html;

      grid.querySelectorAll('.calendar-day.has-event').forEach(el => {
        el.addEventListener('click', () => {
          const day = parseInt(el.dataset.day, 10);
          showEventModal(day, events[day]);
        });
      });

      updateNavDisabled();
    }

    function showEventModal(day, eventList) {
      const modal = document.getElementById('modal');
      const event = eventList[0];

      document.getElementById('modalDate').textContent = `${currentYear}å¹´${currentMonth}æœˆ${day}æ—¥`;
      document.getElementById('modalTitle').textContent = event.name;
      document.getElementById('modalTime').textContent = event.time || 'æ™‚é–“æœªå®š';

      const mapLink = document.getElementById('modalMap');
      if (event.lat && event.lng) {
        mapLink.href = `https://www.google.com/maps?q=${event.lat},${event.lng}`;
        mapLink.style.display = 'block';
      } else {
        mapLink.style.display = 'none';
      }
      modal.classList.add('active');
    }

    document.getElementById('modal').addEventListener('click', e => {
      if (e.target.id === 'modal' || e.target.id === 'modalClose') {
        document.getElementById('modal').classList.remove('active');
      }
    });

    document.getElementById('prevMonth').addEventListener('click', () => {
      if (minYM && ymToNum(currentYear, currentMonth) <= ymToNum(minYM.y, minYM.m)) return;
      currentMonth--;
      if (currentMonth < 1) { currentMonth = 12; currentYear--; }
      const clamped = clampYM(currentYear, currentMonth);
      currentYear = clamped.y; currentMonth = clamped.m;
      renderCalendar();
    });

    document.getElementById('nextMonth').addEventListener('click', () => {
      if (maxYM && ymToNum(currentYear, currentMonth) >= ymToNum(maxYM.y, maxYM.m)) return;
      currentMonth++;
      if (currentMonth > 12) { currentMonth = 1; currentYear++; }
      const clamped = clampYM(currentYear, currentMonth);
      currentYear = clamped.y; currentMonth = clamped.m;
      renderCalendar();
    });

    function initCalendarRangeAndStartMonth() {
      computeMinMaxYM();

      const t = new Date();
      const desired = clampYM(t.getFullYear(), t.getMonth() + 1);
      currentYear = desired.y;
      currentMonth = desired.m;

      // ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚‹ãªã‚‰ â€œæœ€å¾Œã®æœˆâ€ ã‚’åˆæœŸè¡¨ç¤ºã«ã—ãŸã„å ´åˆã¯ã“ã£ã¡
      // if (maxYM) { currentYear = maxYM.y; currentMonth = maxYM.m; }
    }

    // ===== map =====
    function initMap() {
      if (!window.L) return; // Leaflet æœªãƒ­ãƒ¼ãƒ‰æ™‚ã®ä¿é™º

      mapInstance = L.map('map').setView([35.75, 139.75], 10);
      L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
        attribution: 'Â© OSM Â© CARTO'
      }).addTo(mapInstance);

      const icon = L.icon({ iconUrl: 'icon.png', iconSize: [44, 44], iconAnchor: [22, 32], popupAnchor: [0, -28] });

      const spots = getAllSpotsFlat();
      const list = document.getElementById('spotList');
      list.innerHTML = "";
      markersArray = [];

      spots.forEach((s, i) => {
        if (s.lat && s.lng) {
          const m = L.marker([s.lat, s.lng], { icon }).addTo(mapInstance).bindPopup(
            `<strong>${s.name}</strong><br>${s.year ? (s.year + 'å¹´') : ''}${s.date}${s.time ? ' ãƒ» ' + s.time : ''}<br>` +
            `<a href="https://www.google.com/maps?q=${s.lat},${s.lng}" target="_blank">Googleãƒãƒƒãƒ—ã§é–‹ã</a>`
          );
          markersArray[i] = m;
        }
        const li = document.createElement('li');
        li.innerHTML = `<span class="spot-name">${s.name}</span> <span class="badge">${s.year ? (s.year + '/') : ''}${s.date}</span>`;
        li.addEventListener('click', () => {
          if (markersArray[i]) {
            mapInstance.setView(markersArray[i].getLatLng(), 14, { animate: true });
            markersArray[i].openPopup();
          }
        });
        list.appendChild(li);
      });

      const existing = markersArray.filter(Boolean);
      if (existing.length) mapInstance.fitBounds(L.featureGroup(existing).getBounds().pad(0.15));
    }

    // ===== SW register =====
    async function registerSW() {
      if (!('serviceWorker' in navigator)) return null;
      return await navigator.serviceWorker.register(SW_URL, { scope: BASE });
    }

    // ===== push helpers =====
    function b64ToUint8Array(base64String) {
      const padding = '='.repeat((4 - (base64String.length % 4)) % 4);
      const base64 = (base64String + padding).replace(/-/g, '+').replace(/_/g, '/');
      const rawData = atob(base64);
      const outputArray = new Uint8Array(rawData.length);
      for (let i = 0; i < rawData.length; ++i) outputArray[i] = rawData.charCodeAt(i);
      return outputArray;
    }

    async function getVapidPublicKey() {
      const res = await fetch(`${PUSH_API_BASE}/vapid`, { method: "GET" });
      const data = await res.json().catch(() => ({}));
      if (!res.ok || !data.publicKey) throw new Error(data.error || "vapid fetch failed");
      return data.publicKey;
    }

    function getSelectedHour() {
      const v = document.querySelector('input[name="notifyHour"]:checked')?.value || "21";
      return (v === "18") ? 18 : 21;
    }

    function getSelectedPlaces() {
      const all = document.getElementById("place_all").checked;
      if (all) return [];
      return [...document.querySelectorAll(".placeChk:checked")].map(x => x.value);
    }

    function syncPlaceUI() {
      const all = document.getElementById("place_all").checked;
      const placeOptions = document.querySelectorAll("#placeList .settings-option");
      placeOptions.forEach(opt => {
        if (all) opt.classList.add("disabled");
        else opt.classList.remove("disabled");
      });
      document.querySelectorAll(".placeChk").forEach(chk => {
        chk.disabled = all;
        if (all) chk.checked = false;
      });
    }

    document.getElementById("place_all").addEventListener("change", syncPlaceUI);
    document.querySelectorAll(".placeChk").forEach(chk => chk.addEventListener("change", () => {
      if (chk.checked) document.getElementById("place_all").checked = false;
      syncPlaceUI();
    }));

    async function upsertSubscription(subscription, hour, places) {
      const body = { subscription, places, hour };
      const res = await fetch(`${PUSH_API_BASE}/subs/upsert`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(body)
      });
      const data = await res.json().catch(() => ({}));
      if (!res.ok || !data.ok) throw new Error(data.error || "upsert failed");
      return data;
    }

    async function doPushRegister() {
      const statusEl = document.getElementById("pushStatus");
      statusEl.className = "settings-status loading";
      statusEl.textContent = "â³ ç™»éŒ²ä¸­â€¦";

      if (!("Notification" in window)) {
        statusEl.className = "settings-status error";
        statusEl.textContent = "âŒ ã“ã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯é€šçŸ¥ã«æœªå¯¾å¿œ";
        return;
      }

      const reg = await registerSW();
      if (!reg) {
        statusEl.className = "settings-status error";
        statusEl.textContent = "âŒ SWç™»éŒ²ã«å¤±æ•—";
        return;
      }

      if (!reg.pushManager) {
        statusEl.className = "settings-status error";
        statusEl.textContent = "âŒ Pushæœªå¯¾å¿œï¼ˆiPhoneã¯ãƒ›ãƒ¼ãƒ ç”»é¢ã«è¿½åŠ ã—ã¦Safariã§é–‹ãï¼‰";
        return;
      }

      const perm = await Notification.requestPermission();
      if (perm !== "granted") {
        statusEl.className = "settings-status error";
        statusEl.textContent = "âŒ é€šçŸ¥ãŒè¨±å¯ã•ã‚Œã¦ã„ã¾ã›ã‚“";
        return;
      }

      const publicKey = await getVapidPublicKey();

      let sub = await reg.pushManager.getSubscription();
      if (!sub) {
        sub = await reg.pushManager.subscribe({
          userVisibleOnly: true,
          applicationServerKey: b64ToUint8Array(publicKey)
        });
      }

      const hour = getSelectedHour();
      const places = getSelectedPlaces();

      await upsertSubscription(sub, hour, places);

      statusEl.className = "settings-status success";
      statusEl.textContent = "âœ… ç™»éŒ²å®Œäº†ï¼é€šçŸ¥ãŒå±Šãã‚ˆã†ã«ãªã‚Šã¾ã—ãŸ";
    }

    document.getElementById("pushBtn").addEventListener("click", () => {
      doPushRegister().catch(err => {
        console.error(err);
        const statusEl = document.getElementById("pushStatus");
        statusEl.className = "settings-status error";
        statusEl.textContent = "âŒ " + (err?.message || String(err));
      });
    });

    document.addEventListener('DOMContentLoaded', () => {
      syncPlaceUI();

      // â˜…ã“ã“ãŒé‡è¦ï¼šãƒ‡ãƒ¼ã‚¿ç¯„å›²ã‚’èª­ã‚“ã§ã‹ã‚‰è¡¨ç¤ºé–‹å§‹
      initCalendarRangeAndStartMonth();
      renderCalendar();

      registerSW().catch(() => {});
    });
  </script>
</body>
</html>
